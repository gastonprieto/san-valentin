<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Carta interactiva y divertida de Dudu y Bubu para San ValentÃ­n.">
  <title>Dudu & Bubu ğŸ’– | Carta interactiva</title>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --bg-start: #ffe6f0;
      --bg-end: #fff6fb;
      --card: #ffffff;
      --text: #49111c;
      --primary: #ff2e75;
      --primary-dark: #d10c55;
      --secondary: #6c757d;
      --shadow: 0 14px 30px rgba(255, 46, 117, 0.20);
      --radius: 22px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Nunito", "Segoe UI", Roboto, sans-serif;
      color: var(--text);
      background: linear-gradient(145deg, var(--bg-start), var(--bg-end));
      display: grid;
      place-items: center;
      padding: 1rem;
    }

    .app {
      width: min(680px, 100%);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(1rem, 3vw, 2rem);
      position: relative;
      overflow: clip;
    }

    .badge {
      display: inline-flex;
      gap: .4rem;
      align-items: center;
      font-size: .85rem;
      padding: .45rem .8rem;
      border-radius: 999px;
      background: #ffe1ec;
      color: #a90f4b;
      font-weight: 700;
    }

    h1 {
      margin: .8rem 0 .6rem;
      font-size: clamp(1.3rem, 4vw, 2rem);
      line-height: 1.2;
      color: #7a0031;
      text-wrap: balance;
    }

    p { margin: .35rem 0; line-height: 1.45; }

    .screen { display: none; }
    .screen.active { display: block; }

    .media {
      margin: .9rem 0;
      border-radius: 16px;
      overflow: hidden;
      background: #fff8fc;
      border: 1px solid #ffd4e5;
      min-height: 220px;
      display: grid;
      place-items: center;
    }

    .media img {
      width: 100%;
      height: min(52vw, 320px);
      object-fit: cover;
      display: block;
    }

    .caption {
      font-size: .85rem;
      color: #8c3564;
      margin-top: -.2rem;
    }

    .question {
      font-size: clamp(1.25rem, 3.4vw, 1.6rem);
      min-height: 56px;
      font-weight: 700;
      color: #a00043;
    }

    .btn-row {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      min-height: 84px;
      flex-wrap: wrap;
      margin-top: .8rem;
    }

    button {
      border: 0;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 800;
      transition: transform .2s ease, background .2s ease, box-shadow .2s ease;
      -webkit-tap-highlight-color: transparent;
    }

    button:focus-visible {
      outline: 3px dashed #620026;
      outline-offset: 3px;
    }

    #btn-si {
      background: var(--primary);
      color: #fff;
      padding: .9rem 1.6rem;
      font-size: 1.15rem;
      box-shadow: 0 10px 18px rgba(255, 46, 117, 0.35);
      animation: heartbeat 1.2s infinite;
    }

    #btn-si:hover { transform: translateY(-2px); background: var(--primary-dark); }

    #btn-no {
      background: var(--secondary);
      color: #fff;
      padding: .8rem 1.2rem;
      font-size: 1rem;
      position: static;
    }

    .step-gift {
      text-align: center;
      min-height: 58vh;
      display: grid;
      align-content: center;
      justify-items: center;
      gap: .8rem;
    }

    #giftBtn {
      width: min(220px, 55vw);
      aspect-ratio: 1 / 1;
      border-radius: 20px;
      border: 2px dashed #ffc2d9;
      background: #fff0f6;
      font-size: clamp(3rem, 11vw, 5rem);
      animation: bounce 1s infinite;
    }

    .progress {
      display: flex;
      gap: .5rem;
      margin-top: 1rem;
      justify-content: center;
    }

    .dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: #ffbdd3;
    }

    .dot.active { background: #e80058; }

    .sources {
      margin-top: 1rem;
      font-size: .8rem;
      color: #694352;
    }

    .sources a { color: #9a0043; }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }

    @media (max-width: 420px) {
      .app { padding: 1rem; }
      .btn-row { min-height: 110px; }
      #btn-no { font-size: .95rem; }
    }
  </style>
</head>
<body>
  <main class="app" aria-live="polite">
    <section id="step1" class="screen active" aria-labelledby="title1">
      <span class="badge">ğŸ’˜ Carta interactiva</span>
      <h1 id="title1">Â¿Quieres seguir saliendo conmigo? ğŸ¥º</h1>
      <p id="dynamicText" class="question">Prometo mÃ¡s risas, mÃ¡s abrazos y mÃ¡s planes bonitos ğŸ’•</p>

      <figure class="media" id="mediaStep1">
        <img id="imageMain" loading="lazy" alt="Dudu y Bubu abrazÃ¡ndose" src="assets/dudu-bubu-love.svg">
      </figure>
      <p class="caption">Dudu y Bubu mode: activado ğŸ¼ğŸ»</p>

      <div class="btn-row" id="btnArea">
        <button id="btn-si" type="button" aria-label="Responder que sÃ­">Â¡SÃ, OBVIO! â¤ï¸</button>
        <button id="btn-no" type="button" aria-label="Responder que no">No ğŸ˜¶</button>
      </div>
    </section>

    <section id="step2" class="screen step-gift" aria-labelledby="title2">
      <span class="badge">ğŸ Sorpresa desbloqueada</span>
      <h1 id="title2">Â¡SabÃ­a que dirÃ­as que sÃ­! ğŸ˜</h1>
      <p>Toca el regalo para abrir el premio especial de Dudu y Bubu.</p>
      <button id="giftBtn" type="button" aria-label="Abrir regalo">ğŸ</button>
    </section>

    <section id="step3" class="screen" aria-labelledby="title3">
      <span class="badge">ğŸ’‹ Final feliz</span>
      <h1 id="title3">Â¡Te amo muchÃ­simo! ğŸ’–</h1>
      <figure class="media">
        <img loading="lazy" alt="Dudu y Bubu mandando besos" src="assets/dudu-bubu-kiss.svg">
      </figure>
      <p class="question">Mil millones de besitos para ti âœ¨ğŸ’‹</p>
    </section>

    <div class="progress" aria-hidden="true">
      <span class="dot active" data-dot="0"></span>
      <span class="dot" data-dot="1"></span>
      <span class="dot" data-dot="2"></span>
    </div>

    <p class="sources">
      ImÃ¡genes de Dudu y Bubu guardadas localmente en <code>/assets</code> para que carguen mÃ¡s rÃ¡pido.
      <br>
      Para publicar en GitHub Pages: crea un repositorio, sube este <code>index.html</code> y en <b>Settings â†’ Pages</b> elige la rama principal.
    </p>
  </main>

  <script>
    const phrases = [
      'Â¿Segura? Mira esa carita tierna de Dudu ğŸ¥º',
      'Bubu ya preparÃ³ plan de pelis + cobija ğŸ¿',
      'Prometo helado, abrazos y cero dramas ğŸ¦',
      'Ãšltima oferta: besos infinitos y memes diarios ğŸ˜˜',
      'Vamos, di sÃ­â€¦ que ya tengo playlist romÃ¡ntica ğŸ¶'
    ];

    const images = [
      'assets/dudu-bubu-love.svg',
      'assets/dudu-bubu-cute.svg',
      'assets/dudu-bubu-hug.svg',
      'assets/dudu-bubu-heart.svg'
    ];

    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    const dots = [...document.querySelectorAll('.dot')];
    const btnNo = document.getElementById('btn-no');
    const btnSi = document.getElementById('btn-si');
    const dynamicText = document.getElementById('dynamicText');
    const imageMain = document.getElementById('imageMain');
    const giftBtn = document.getElementById('giftBtn');

    let index = 0;
    let yesScale = 1;
    let confettiLoop;

    function setStep(step) {
      [step1, step2, step3].forEach((node, i) => node.classList.toggle('active', i === step));
      dots.forEach((dot, i) => dot.classList.toggle('active', i === step));
    }

    function moveNoButton() {
      const isMobile = window.matchMedia('(max-width: 768px)').matches;
      btnNo.style.position = 'fixed';
      const maxX = Math.max(window.innerWidth - btnNo.offsetWidth - 8, 0);
      const maxY = Math.max(window.innerHeight - btnNo.offsetHeight - 8, 0);
      btnNo.style.left = `${Math.random() * maxX}px`;
      btnNo.style.top = `${Math.random() * maxY}px`;

      dynamicText.textContent = phrases[index % phrases.length];
      imageMain.src = images[index % images.length];
      imageMain.alt = `Dudu y Bubu en modo tierno #${(index % images.length) + 1}`;

      yesScale = Math.min(yesScale + (isMobile ? 0.08 : 0.13), 1.9);
      btnSi.style.transform = `scale(${yesScale})`;
      index += 1;
    }

    function safeConfetti(options) {
      if (typeof window.confetti === 'function') {
        window.confetti(options);
      }
    }

    btnNo.addEventListener('pointerdown', (event) => {
      event.preventDefault();
      moveNoButton();
    });

    btnSi.addEventListener('click', () => {
      setStep(1);
      safeConfetti({ particleCount: 180, spread: 90, origin: { y: 0.65 } });
    });

    giftBtn.addEventListener('click', () => {
      setStep(2);
      clearInterval(confettiLoop);
      confettiLoop = setInterval(() => {
        safeConfetti({
          particleCount: 7,
          angle: 60,
          spread: 60,
          origin: { x: 0 },
          colors: ['#ff2e75', '#ff92bb', '#ff4f8e']
        });
        safeConfetti({
          particleCount: 7,
          angle: 120,
          spread: 60,
          origin: { x: 1 },
          colors: ['#ff2e75', '#ff92bb', '#ff4f8e']
        });
      }, 380);
    });

    window.addEventListener('beforeunload', () => clearInterval(confettiLoop));
  </script>
</body>
</html>
